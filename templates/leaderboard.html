{% extends "base.html" %}

{% block title %}Leaderboard{% endblock %}

{% block content %}
<div class="container">
    <h1>Leaderboard</h1>
    <div id="difficulty-buttons">
        <button class="difficulty-button selected" onclick="showLeaderboard('easy', this)">Easy</button>
        <button class="difficulty-button" onclick="showLeaderboard('medium', this)">Medium</button>
        <button class="difficulty-button" onclick="showLeaderboard('hard', this)">Hard</button>
    </div>
    <div id="leaderboard-content"></div>
</div>
{% endblock %}

{% block scripts %}
<script>
    function showLeaderboard(difficulty, buttonElement) {
        // Update selected button
        document.querySelectorAll('.difficulty-button').forEach(btn => btn.classList.remove('selected'));
        buttonElement.classList.add('selected');

        fetch(`/leaderboard/${difficulty}`)
            .then(response => {
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                return response.json();
            })
            .then(data => {
                let html = `<h2>${difficulty.charAt(0).toUpperCase() + difficulty.slice(1)} Mode</h2>
                            <div class="table-container">
                                <table>
                                    <thead>
                                        <tr>
                                            <th>Rank</th>
                                            <th>Player</th>
                                            <th>Score</th>
                                        </tr>
                                    </thead>
                                    <tbody>`;
                data.forEach((score, index) => {
                    html += `<tr>
                                <td>${index + 1}</td>
                                <td>${score.username}</td>
                                <td>${score.score}</td>
                            </tr>`;
                });
                html += '</tbody></table></div>';
                document.getElementById('leaderboard-content').innerHTML = html;
            })
            .catch(error => {
                console.error('Error loading leaderboard:', error);
                document.getElementById('leaderboard-content').innerHTML = 'Failed to load leaderboard. Please try again later.';
            });
    }

    // Show Easy leaderboard by default when the page loads
    document.addEventListener('DOMContentLoaded', () => {
        showLeaderboard('easy', document.querySelector('.difficulty-button'));
    });
</script>
{% endblock %}